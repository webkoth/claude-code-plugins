---
description: Initialize deployment configuration for current project
allowed-tools: Read, Write, Glob, Grep, Bash
---

# Initialize Deployment Configuration

Create a `.deploy.yml` configuration file for the current project.

## Process

1. **Detect project type** by checking for:
   - `package.json` with `next` → Next.js
   - `package.json` → Node.js
   - `requirements.txt` or `pyproject.toml` → Python
   - `composer.json` → PHP
   - `index.html` or `dist/` → Static

2. **Detect git repository**:
   ```bash
   git remote get-url origin  # Get repo URL
   git branch --show-current  # Get current branch
   ```

3. **Gather information**:
   - Project name (from package.json, pyproject.toml, or directory name)
   - Git repository URL and branch
   - Build command (if applicable)
   - Start command
   - Port number
   - Required environment variables

4. **Create `.deploy.yml`** with detected configuration

5. **Ask user** for server IP and domain if not already configured

## Example output

```yaml
# .deploy.yml - Generated by tw-deploy
name: my-app
type: nextjs
server: 77.232.136.239
domain: example.com
port: 3000

# Git-based deployment
git:
  repo: git@github.com:user/my-app.git
  branch: main
  deploy_path: /var/www/my-app

ssh:
  user: root
  password_env: SERVER_PASSWORD

build:
  command: npm run build

start:
  command: npm start

env:
  - DATABASE_URL
  - NODE_ENV=production

pm2:
  name: my-app
  instances: 1
```

## Notes

- If `.deploy.yml` already exists, ask before overwriting
- Validate server connectivity if IP is provided
- Ensure git remote is configured for git-based deploy
- Check that MCP Timeweb is available for server management
